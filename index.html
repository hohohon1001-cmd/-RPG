<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìœ ê¸°ì‚¬ RPG â€“ ì™„ì „íŒ</title>
<style>
body{margin:0;height:100vh;background:radial-gradient(circle at top,#2a2d44,#000);
font-family:'Segoe UI',sans-serif;color:#e6e8ff;display:flex;justify-content:center;align-items:center;}
.container{width:95%;max-width:540px;background:linear-gradient(180deg,#1a1d2b,#0b0d15);
border-radius:30px;padding:18px;box-shadow:0 0 60px rgba(0,0,0,.95);}
.hud{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;}
.hud-box{background:#0e1018;border-radius:16px;text-align:center;font-size:11px;padding:6px 0;}
.hud-box span{display:block;font-size:16px;font-weight:bold;color:#9fa8ff;}
.area{text-align:center;margin:10px 0;font-weight:bold;color:#aab0ff;}
.monster{background:radial-gradient(circle at top,#242840,#0c0e18);border-radius:28px;padding:26px 14px;text-align:center;cursor:pointer;user-select:none;}
.monster-name{font-size:22px;margin-bottom:8px;}
.hp-bar{width:100%;height:14px;background:#111;border-radius:10px;overflow:hidden;}
.hp-fill{height:100%;background:linear-gradient(90deg,#ff3b3b,#ff9b9b);width:100%;transition:.1s;}
.btn{width:100%;margin-top:8px;padding:14px;border-radius:20px;border:none;cursor:pointer;font-size:15px;font-weight:bold;color:white;background:linear-gradient(#5865F2,#404EED);}
.btn.awaken{background:linear-gradient(90deg,#ff2d2d,#ffd700,#9b4dff);}
.btn.job{background:linear-gradient(90deg,#ffd700,#ff4d4d,#9b4dff);}
.btn.auto{background:linear-gradient(90deg,#00ff9b,#00a676);margin-top:4px;}
.log{text-align:center;margin-top:8px;font-size:13px;color:#b7bbff;min-height:18px;}
</style>
</head>
<body>
<div class="container">

<div class="hud">
 <div class="hud-box">LV<span id="playerLv">1</span></div>
 <div class="hud-box">ì§ì—…<span id="jobText">ë©œë¡œìš°ê¸‰</span></div>
 <div class="hud-box">ATK<span id="atk">1</span></div>
 <div class="hud-box">ê°•í™”<span id="upgradeLv">1</span></div>
 <div class="hud-box">ğŸ’°<span id="coin">0</span></div>
 <div class="hud-box">EXP<span id="expText">0/10</span></div>
</div>

<div id="areaText" class="area">ğŸŒ± ì´ˆì›</div>

<div class="monster" onclick="attack()">
 <div id="monsterName" class="monster-name">ë©œë‹˜</div>
 <div class="hp-bar"><div id="hpFill" class="hp-fill"></div></div>
</div>

<button id="upgradeBtn" class="btn" onclick="upgrade()">ğŸ”§ ê°•í™” (<span id="upgradeCost">20</span>ğŸ’°)</button>
<button id="jobBtn" class="btn job" onclick="jobChange()" style="display:none;">ğŸ”® ì „ì§</button>
<button id="autoBtn" class="btn auto" onclick="toggleAuto()">ğŸ¤– ìë™ì‚¬ëƒ¥ OFF</button>

<div id="log" class="log">ê²Œì„ ì‹œì‘! í™”ë©´ í´ë¦­ í›„ ì‚¬ìš´ë“œ í™œì„±í™”</div>

// í´ë¦­ ì´ë²¤íŠ¸ë¡œ í•œ ë²ˆë§Œ ì‹¤í–‰
document.body.addEventListener("click", enableSound, { once: true });
 <audio id="hitSound" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-hit-2187.mp3"></audio>
<audio id="killSound" src="https://assets.mixkit.co/sfx/preview/mixkit-video-game-win-2016.mp3"></audio>
<audio id="upgradeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
<audio id="failSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
<audio id="levelSound" src="https://assets.mixkit.co/sfx/preview/mixkit-magic-game-win-1949.mp3"></audio>
<audio id="bossSound" src="https://assets.mixkit.co/sfx/preview/mixkit-dramatic-hit-166.mp3"></audio>

<script>
/* ===== ë³€ìˆ˜ ===== */
let coins=0, atk=1, playerLv=1, exp=0, nextExp=10;
let upgradeLv=1, upgradeChance=90;
let job="ì´ˆë³´ì", jobStage=0, goldBonus=1;
let monsterHp=10, monsterMaxHp=10, kills=0;
let autoHunt=false, autoInterval=null;
let soundEnabled=false;

/* ===== ì§€ì—­/ëª¬ìŠ¤í„° ===== */
const areas=[
 {name:"ğŸŒ± ì¼ëª»íƒ€",lv:1},{name:"ğŸŒ´ ê¸‰ëª»íƒ€",lv:10},{name:"â„ ìœ ê¸°ì‚¬ì˜ ì°¨ê°€ìš´ ë†ë‹´",lv:20},
 {name:"ğŸœ ì‹íƒ",lv:30},{name:"ğŸŒ‹ íŒ€ë‚˜ë¹ ",lv:40},{name:"ğŸŒŒ ìœ ê¸°ì‚¬ ë””ìŠ¤ì½”ë“œ",lv:50}
];
const monsters=[
 ["ì–´ë ¤ì›Œ í•˜ì‹œëŠ” ë©œë‹˜","ë²¨í‚¤ë‹˜"],
 ["ë˜ ëª»ê¹¨ê³  ìˆëŠ” ë©œë‹˜","ë¨¼ì €ê¹¬ ìš°ì°¸ë‹˜"],
 ["ì™•ì´ ë„˜ì–´ì§€ë©´? í‚¹ì½© ã…‹ã…‹ã…‹","ì•„ë‹ˆ ì‹¤ìˆ˜ë¡œ ë¼ì´ë²Œ ë“¤ì–´ê°"],
 ["ì˜·ì— ë–¨ì–´ì§„ ë°¥í’€","í›„ì‹ìœ¼ë¡  ì¤€ë¸Œë ˆë“œ ì—‰ë©ì´"],
 ["ì§­ ìœ ê¸°ì‚¬","ë©œë‹˜ìœ¼ë¡œ ìœ„ì¥í•œ ì¤€ë¸Œë ˆë“œ"],
 ["ìì¹¼ë‹˜","í‘í™”í•œ ë©œë‹˜","ë³´ìŠ¤: ìœ ê¸°ì‚¬ok"]
];

/* ===== UI ===== */
const playerLvSpan = document.getElementById("playerLv");
const atkSpan = document.getElementById("atk");
const upgradeLvSpan = document.getElementById("upgradeLv");
const coinSpan = document.getElementById("coin");
const expTextSpan = document.getElementById("expText");
const jobTextSpan = document.getElementById("jobText");
const upgradeCostSpan = document.getElementById("upgradeCost");
const hpFillElem = document.getElementById("hpFill");
const monsterNameElem = document.getElementById("monsterName");
const areaTextElem = document.getElementById("areaText");
const logElem = document.getElementById("log");
const upgradeBtnElem = document.getElementById("upgradeBtn");
const jobBtnElem = document.getElementById("jobBtn");
const autoBtnElem = document.getElementById("autoBtn");

const hitSound = document.getElementById("hitSound");
const killSound = document.getElementById("killSound");
const upgradeSound = document.getElementById("upgradeSound");
const failSound = document.getElementById("failSound");
const levelSound = document.getElementById("levelSound");
const bossSound = document.getElementById("bossSound");

/* ===== ë¸Œë¼ìš°ì € ì •ì±… ëŒ€ë¹„ ì‚¬ìš´ë“œ ì´ˆê¸°í™” ===== */
document.body.addEventListener("click", ()=>{
  [hitSound, killSound, upgradeSound, failSound, levelSound, bossSound].forEach(s=>{
    s.play().catch(()=>{});
    s.pause();
    s.currentTime=0;
  });
  soundEnabled=true;
  logElem.textContent = "ğŸ”Š ì‚¬ìš´ë“œ í™œì„±í™” ì™„ë£Œ!";
},{once:true});

/* ===== ì €ì¥ ===== */
function save(){
  try{
    const data = {
      coins: Number(coins) || 0,
      atk: Number(atk) || 1,
      playerLv: Number(playerLv) || 1,
      exp: Number(exp) || 0,
      nextExp: Number(nextExp) || 10,
      upgradeLv: Number(upgradeLv) || 1,
      upgradeChance: Number(upgradeChance) || 90,
      job: job || "ì´ˆë³´ì",
      jobStage: Number(jobStage) || 0,
      goldBonus: Number(goldBonus) || 1,
      kills: Number(kills) || 0
    };
    localStorage.setItem("yugisaRPG2", JSON.stringify(data));
    // ì„ íƒ: ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„ ê¸°ë¡
    localStorage.setItem("yugisaRPG2_time", String(Date.now()));
  }catch(e){
    console.error("Save failed:", e);
  }
}

/* ===== ë¶ˆëŸ¬ì˜¤ê¸° ===== */
function load(){
  const raw = localStorage.getItem("yugisaRPG2");
  if(!raw) return; // ì €ì¥ ì—†ìŒ -> ê¸°ë³¸ê°’ ìœ ì§€
  try{
    const s = JSON.parse(raw);
    // íƒ€ì…ê²€ì‚¬ ë° ì•ˆì „ í• ë‹¹ (let ë³€ìˆ˜ì— ì§ì ‘ í• ë‹¹!)
    if(typeof s !== "object" || s === null) throw new Error("Bad save data");
    coins = Number(s.coins) || 0;
    atk = Number(s.atk) || 1;
    playerLv = Number(s.playerLv) || 1;
    exp = Number(s.exp) || 0;
    nextExp = Number(s.nextExp) || 10;
    upgradeLv = Number(s.upgradeLv) || 1;
    upgradeChance = Number(s.upgradeChance) || 90;
    job = typeof s.job === "string" ? s.job : "ì´ˆë³´ì";
    jobStage = Number(s.jobStage) || 0;
    goldBonus = Number(s.goldBonus) || 1;
    kills = Number(s.kills) || 0;

    console.log("Save loaded:", s);
  }catch(err){
    console.warn("Failed to load save (corrupt?). Clearing save. Error:", err);
    // í•„ìš”í•˜ë©´ ìë™ìœ¼ë¡œ ì§€ìš°ê¸° (ì‚¬ìš©ìì—ê²Œ ê²½ê³  í›„ ì§€ìš°ëŠ” ê²Œ ì•ˆì „)
    // localStorage.removeItem("yugisaRPG2");
  }
}

/* ===== UI ê°±ì‹  ===== */
function updateUI(){
 hpFillElem.style.width = (monsterHp/monsterMaxHp*100)+"%";
 playerLvSpan.textContent = playerLv;
 expTextSpan.textContent = `${exp}/${nextExp}`;
 atkSpan.textContent = atk;
 coinSpan.textContent = coins;
 upgradeLvSpan.textContent = upgradeLv;
 upgradeCostSpan.textContent = 20 + upgradeLv*6;
 jobTextSpan.textContent = job;
 if(upgradeLv>=10) upgradeBtnElem.classList.add("awaken");
 save();
 checkJob();
}

/* ===== ì§€ì—­ ì¸ë±ìŠ¤ ===== */
function areaIndex(){
 let i=0;
 for(let a=0;a<areas.length;a++) if(playerLv>=areas[a].lv) i=a;
 return i;
}

/* ===== ëª¬ìŠ¤í„° ìƒì„± ===== */
function spawnMonster(){
 const a=areaIndex();
 monsterMaxHp = 30 + a*40 + kills*2;
 monsterHp = monsterMaxHp;
 monsterNameElem.textContent = monsters[a][Math.floor(Math.random()*monsters[a].length)];
 areaTextElem.textContent = areas[a].name;
 if(a===5 && monsterNameElem.textContent.includes("ë³´ìŠ¤") && soundEnabled){
   bossSound.currentTime=0; bossSound.play().catch(()=>{});
 }
 updateUI();
}

/* ===== ì „íˆ¬ ===== */
function attack(){
 monsterHp -= atk;
 if(soundEnabled){ hitSound.currentTime=0; hitSound.play().catch(()=>{});}
 if(monsterHp<=0){
   if(soundEnabled){ killSound.currentTime=0; killSound.play().catch(()=>{});}
   kills++;
   coins += Math.random()<0.05?100:Math.floor((10+areaIndex()*6)*goldBonus);
   if(Math.random()<0.05) logElem.textContent="ğŸŒˆ ë¬´ì§€ê°œ ê³¨ë“œ!";
   exp += Math.floor((8+areaIndex()*6)*(1+upgradeLv*0.1+goldBonus));
   levelUp();
   spawnMonster();
 }
 updateUI();
}

/* ===== ë ˆë²¨ì—… ===== */
function levelUp(){
 while(exp>=nextExp){
   exp -= nextExp;
   playerLv++;
   nextExp = Math.floor(nextExp*1.5);
   atk++;
   if(soundEnabled){ levelSound.currentTime=0; levelSound.play().catch(()=>{});}
   logElem.textContent = `ğŸ‰ ë ˆë²¨ì—…! LV ${playerLv}`;
 }
}

/* ===== ê°•í™” ===== */
function upgrade(){
 const cost = 20 + upgradeLv*6;
 if(coins<cost){ logElem.textContent="ğŸ’¸ ê³¨ë“œ ë¶€ì¡±!"; if(soundEnabled){failSound.currentTime=0; failSound.play().catch(()=>{});} return;}
 coins -= cost;
 let chance = upgradeLv>=10?95:upgradeChance;
 if(Math.random()*100<=chance){
   upgradeLv++;
   atk += upgradeLv>=10?2:1;
   upgradeChance = Math.max(10, upgradeChance-2);
   if(soundEnabled){ upgradeSound.currentTime=0; upgradeSound.play().catch(()=>{});}
   logElem.textContent = "âœ¨ ê°•í™” ì„±ê³µ!";
 }else{
   if(soundEnabled){ failSound.currentTime=0; failSound.play().catch(()=>{});}
   logElem.textContent="ğŸ’¥ ê°•í™” ì‹¤íŒ¨â€¦";
 }
 updateUI();
}

/* ===== ì „ì§ ===== */
function checkJob(){
 if(playerLv>=20 && jobStage===0) jobBtnElem.style.display="block";
 if(playerLv>=40 && jobStage===1) jobBtnElem.style.display="block";
 if(playerLv>=60 && jobStage===2) jobBtnElem.style.display="block";
}
function jobChange(){
 if(jobStage===0){ job="âš” ìš°ìœ ì°¸ì¹˜"; atk+=5; jobStage=1;}
 else if(jobStage===1){ job="ğŸ”¥ ì¤€ë¸Œë ˆë“œì—‰ë©ì´"; atk+=10; goldBonus+=0.3; jobStage=2;}
 else if(jobStage===2){ job="ğŸŒŒ ìœ ê¸°ì‚¬"; atk+=20; goldBonus+=0.7; jobStage=3;}
 jobBtnElem.style.display="none";
 logElem.textContent = `ğŸŒŸ ì „ì§ ì™„ë£Œ! ${job}`;
 updateUI();
}

/* ===== ìë™ì‚¬ëƒ¥ ===== */
function toggleAuto(){
 autoHunt = !autoHunt;
 if(autoHunt){
   autoBtnElem.textContent="ğŸ¤– ìë™ì‚¬ëƒ¥ ON";
   autoInterval = setInterval(attack,200);
 } else {
   autoBtnElem.textContent="ğŸ¤– ìë™ì‚¬ëƒ¥ OFF";
   clearInterval(autoInterval);
 }
}

/* ===== ì‹œì‘ ===== */
load();
spawnMonster();
updateUI();
</script>
</div>
</body>
</html>
