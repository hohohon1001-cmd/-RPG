<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìœ ê¸°ì‚¬ RPG</title>

<style>
body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at top, #2b2d31, #000);
    color: #dbdee1;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Segoe UI', sans-serif;
}
.container {
    width: 92%;
    max-width: 480px;
    background: linear-gradient(180deg, #1e1f22, #141517);
    border-radius: 28px;
    padding: 18px;
    box-shadow: 0 0 40px rgba(0,0,0,0.9);
}

/* HUD */
.hud {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
}
.hud-box {
    flex: 1;
    margin: 0 3px;
    background: #111;
    border-radius: 14px;
    padding: 8px 0;
    text-align: center;
    font-size: 12px;
    font-weight: bold;
}
.hud-box span {
    display: block;
    font-size: 16px;
}

/* ë¬´ì§€ê°œ */
.rainbow {
    background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, purple, red);
    background-size: 600% 600%;
    animation: rainbow 2s linear infinite;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
@keyframes rainbow {
    0% { background-position: 0% 50%; }
    100% { background-position: 100% 50%; }
}

/* ì§€ì—­ */
.area {
    text-align: center;
    margin-bottom: 6px;
    color: #9fa1ff;
}

/* ëª¬ìŠ¤í„° */
.monster-box {
    background: radial-gradient(circle at top, #1b1c1f, #0c0d0f);
    border-radius: 26px;
    padding: 26px 16px;
    text-align: center;
    margin-bottom: 10px;
    cursor: pointer;
}
.monster-name {
    font-size: 22px;
    margin-bottom: 8px;
}
.hp-bar {
    width: 100%;
    height: 14px;
    background: #111;
    border-radius: 10px;
    overflow: hidden;
}
.hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff3b3b, #ff7b7b);
    width: 100%;
}

/* ë²„íŠ¼ */
.btn {
    width: 100%;
    padding: 14px;
    margin-top: 8px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 18px;
    border: none;
    cursor: pointer;
    color: white;
    background: linear-gradient(to bottom, #5865F2, #404EED);
}
.btn.awakened {
    background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, purple);
    background-size: 600% 600%;
    animation: rainbow 2s linear infinite;
}

.log {
    margin-top: 6px;
    font-size: 13px;
    color: #aaa;
    text-align: center;
}
</style>
</head>

<body>
<div class="container">

    <div class="hud">
        <div class="hud-box">LV<span id="playerLv">1</span></div>
        <div class="hud-box">ATK<span id="atk">1</span></div>
        <div class="hud-box">ğŸ’°<span id="coin">0</span></div>
        <div class="hud-box">ê°•í™”<span id="upgradeLv">1</span></div>
    </div>

    <div class="hud">
        <div class="hud-box">EXP
            <span><span id="exp">0</span>/<span id="nextExp">10</span></span>
        </div>
    </div>

    <div id="areaText" class="area">ğŸŒ± ì´ˆì›</div>

    <div class="monster-box" onclick="attack()">
        <div id="monsterName" class="monster-name">ìŠ¬ë¼ì„</div>
        <div class="hp-bar"><div id="hpFill" class="hp-fill"></div></div>
    </div>

    <button id="upgradeBtn" class="btn" onclick="upgrade()">
        ğŸ”§ ê°•í™” (<span id="chanceText">90</span>% / <span id="costText">20</span>ğŸ’°)
    </button>

    <button class="btn" onclick="openShop()">ğŸ›’ ìƒì </button>
    <button class="btn" onclick="toggleIdle()">â³ ë°©ì¹˜: <span id="idleState">OFF</span></button>

    <div id="log" class="log">ì—¬ì •ì´ ì‹œì‘ë˜ì—ˆë‹¤â€¦</div>
</div>

<!-- ì‚¬ìš´ë“œ -->
<audio id="hitSound" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-hit-2187.mp3"></audio>
<audio id="upgradeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<script>
/* ================= ê¸°ë³¸ ìŠ¤íƒ¯ ================= */
let coins = 0, atk = 1;
let playerLv = 1, exp = 0, nextExp = 10;
let upgradeLv = 1, upgradeChance = 90;
let kills = 0;

/* ëª¬ìŠ¤í„° */
let monsterHp = 10, monsterMaxHp = 10;

/* ë°©ì¹˜ */
let idle = false, idleTimer = null;

/* ê³¨ë“œ */
const bonusGoldChance = 20;
const bonusGoldAmount = 30;

/* ì§€ì—­ */
const areas = ["ğŸŒ± ì´ˆì›","ğŸŒ´ ë°€ë¦¼","â„ ëˆˆ","ğŸŒ‹ í™”ì‚°","ğŸŒŒ ê³µí—ˆ"];
const areaLvReq = [1,10,20,30,40];
const monsters = [
  ["ìŠ¬ë¼ì„","ë²„ì„¯ê´´ë¬¼"],
  ["ê³ ë¸”ë¦°","ë…ê±°ë¯¸"],
  ["ì„¤ì¸","ë¹™ê²°ìˆ˜"],
  ["í™”ì—¼ë ¹","ìš©ì•”ê´´ë¬¼"],
  ["ê³µí—ˆì˜ ëˆˆ","ë§ë ¹"]
];

/* ë³´ìŠ¤ */
const bosses = [
  {name:"ğŸŒ± ì´ˆì›ì˜ ìˆ˜í˜¸ì", hp:120},
  {name:"ğŸŒ´ ë°€ë¦¼ì˜ êµ°ì£¼", hp:300},
  {name:"â„ ì„¤ì‚°ì˜ ì™•", hp:600},
  {name:"ğŸŒ‹ í™”ì‚°ì˜ ìš©", hp:1200},
  {name:"ğŸŒŒ ê³µí—ˆì˜ ì‹ ", hp:3000}
];

/* ìƒì  */
const shopItems = [
  { name:"âš”ï¸ ê³µê²©ë ¥ +1", cost:100, buy(){ atk++; }},
  { name:"ğŸ¯ ê°•í™” í™•ë¥  +5%", cost:150, buy(){ upgradeChance=Math.min(95,upgradeChance+5); }}
];

/* ================= ìœ í‹¸ ================= */
function upgradeCost(){ return 20 + upgradeLv * 10; }
function areaIndex(){ return Math.min(Math.floor(kills/6), areas.length-1); }
function isBoss(){ return kills>0 && kills%10===0; }

/* ================= ëª¬ìŠ¤í„° ================= */
function spawnMonster(){
  const idx = areaIndex();
  if(isBoss()){
    monsterMaxHp = bosses[idx].hp;
    monsterHp = monsterMaxHp;
    monsterName.textContent = bosses[idx].name;
    log.textContent = "ğŸ‘‘ ë³´ìŠ¤ ë“±ì¥!";
  } else {
    monsterMaxHp = 10 + kills*3 + idx*20;
    monsterHp = monsterMaxHp;
    const list = monsters[idx];
    monsterName.textContent = list[Math.floor(Math.random()*list.length)];
  }
  areaText.textContent = `${areas[idx]} (ê¶Œì¥ LV ${areaLvReq[idx]})`;
  updateMonsterUI();
}

/* ================= ê³µê²© ================= */
function attack(){
  monsterHp -= atk;
  hitSound.play();

  if(monsterHp<=0){
    kills++;
    let gold = 5 + areaIndex()*5;
    coins += gold;

    if(Math.random()*100<bonusGoldChance){
      coins += bonusGoldAmount;
      log.textContent = `ğŸ’° ë³´ë„ˆìŠ¤ ê³¨ë“œ +${bonusGoldAmount}!`;
    } else {
      log.textContent = `ëª¬ìŠ¤í„° ì²˜ì¹˜! +${gold}ğŸ’°`;
    }

    if(isBoss()){
      coins += 200;
      upgradeChance += 5;
      log.textContent = "ğŸ‘‘ ë³´ìŠ¤ ì²˜ì¹˜! ëŒ€ëŸ‰ ë³´ìƒ!";
    }

    exp += 3;
    levelUpCheck();
    spawnMonster();
  }
  updateUI();
}

/* ================= ë ˆë²¨ì—… ================= */
function levelUpCheck(){
  while(exp>=nextExp){
    exp -= nextExp;
    playerLv++;
    nextExp = Math.floor(nextExp*1.5);
    atk++;
    log.textContent = `ğŸ‰ ë ˆë²¨ì—…! LV ${playerLv}`;
  }
}

/* ================= ê°•í™” ================= */
function upgrade(){
  const cost = upgradeCost();
  if(coins<cost){
    log.textContent = `ğŸ’¸ ì½”ì¸ ë¶€ì¡± (${cost}ğŸ’° í•„ìš”)`;
    return;
  }
  coins -= cost;

  if(Math.random()*100<=upgradeChance){
    upgradeLv++;
    atk++;
    upgradeChance = Math.max(10,upgradeChance-2);
    upgradeSound.play();
    log.textContent = "ê°•í™” ì„±ê³µ!";
  } else {
    log.textContent = "ê°•í™” ì‹¤íŒ¨â€¦";
  }
  updateUI();
}

/* ================= ìƒì  ================= */
function openShop(){
  let msg="ğŸ›’ ìƒì \n\n";
  shopItems.forEach((i,n)=>msg+=`${n+1}. ${i.name} (${i.cost}ğŸ’°)\n`);
  const c=prompt(msg);
  const item=shopItems[c-1];
  if(!item) return;
  if(coins<item.cost){ log.textContent="ğŸ’¸ ê³¨ë“œ ë¶€ì¡±!"; return; }
  coins-=item.cost;
  item.buy();
  log.textContent=`${item.name} êµ¬ë§¤!`;
  updateUI();
}

/* ================= ë°©ì¹˜ ================= */
function toggleIdle(){
  idle=!idle;
  idleState.textContent=idle?"ON":"OFF";
  idle?idleTimer=setInterval(attack,1000):clearInterval(idleTimer);
}

/* ================= ì €ì¥ ================= */
function saveGame(){
  localStorage.setItem("yugisa_save",JSON.stringify({
    coins,atk,playerLv,exp,nextExp,upgradeLv,upgradeChance,kills
  }));
}
function loadGame(){
  const d=JSON.parse(localStorage.getItem("yugisa_save"));
  if(!d) return;
  ({coins,atk,playerLv,exp,nextExp,upgradeLv,upgradeChance,kills}=d);
}

/* ================= UI ================= */
function updateMonsterUI(){
  hpFill.style.width=(monsterHp/monsterMaxHp*100)+"%";
}
function updateUI(){
  coin.textContent=coins;
  atk.textContent=atk;
  upgradeLv.textContent=upgradeLv;
  chanceText.textContent=upgradeChance;
  costText.textContent=upgradeCost();
  playerLv.textContent=playerLv;
  exp.textContent=exp;
  nextExp.textContent=nextExp;

  if(upgradeLv>=10){
    upgradeBtn.classList.add("awakened");
    upgradeLv.classList.add("rainbow");
  }
  updateMonsterUI();
  saveGame();
}

/* ì‹œì‘ */
loadGame();
spawnMonster();
updateUI();
</script>
</body>
</html>
