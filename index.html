<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ìœ ê¸°ì‚¬ RPG</title>

<style>
body {
    margin: 0;
    background: radial-gradient(circle at top, #2b2d31, #000);
    color: #dbdee1;
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    width: 92%;
    max-width: 480px;
    background: #1e1f22;
    border-radius: 24px;
    padding: 16px;
    box-shadow: 0 0 40px rgba(0,0,0,.8);
}

.hud {
    display: flex;
    gap: 6px;
}
.hud div {
    flex: 1;
    background: #111;
    border-radius: 14px;
    text-align: center;
    padding: 6px 0;
    font-size: 12px;
}
.hud span {
    display: block;
    font-size: 18px;
    font-weight: bold;
}

.area {
    text-align: center;
    margin: 8px 0;
    color: #9fa1ff;
}

.monster {
    background: #0f1012;
    border-radius: 22px;
    padding: 24px;
    text-align: center;
    cursor: pointer;
}
.monster-name {
    font-size: 22px;
}
.hp {
    height: 14px;
    background: #111;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 10px;
}
.hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff3b3b, #ff8b8b);
    width: 100%;
}

.btn {
    width: 100%;
    margin-top: 8px;
    padding: 12px;
    font-size: 15px;
    font-weight: bold;
    border-radius: 16px;
    border: none;
    background: linear-gradient(#5865F2,#404EED);
    color: white;
    cursor: pointer;
}

.shop {
    margin-top: 10px;
    background: #111;
    border-radius: 16px;
    padding: 10px;
    font-size: 13px;
}

.log {
    text-align: center;
    font-size: 13px;
    margin-top: 6px;
    color: #aaa;
}

.awaken {
    background: linear-gradient(90deg, gold, red, purple);
}
</style>
</head>

<body>
<div class="container">

<div class="hud">
    <div>LV<span id="playerLv">1</span></div>
    <div>ATK<span id="atk">1</span></div>
    <div>ê°•í™”<span id="upgradeLv">1</span></div>
    <div>ğŸ’°<span id="coin">0</span></div>
</div>

<div id="areaText" class="area">ğŸŒ± ì´ˆì›</div>

<div class="monster" onclick="attack()">
    <div id="monsterName" class="monster-name">ìŠ¬ë¼ì„</div>
    <div class="hp"><div id="hpFill" class="hp-fill"></div></div>
</div>

<button id="upgradeBtn" class="btn" onclick="upgrade()">ê°•í™” (<span id="chance">90</span>%)</button>
<button class="btn" onclick="toggleIdle()">ë°©ì¹˜: <span id="idleText">OFF</span></button>

<div class="shop">
    ğŸ›’ ìƒì <br>
    <button class="btn" onclick="buyAtk()">ATK +1 (50ğŸ’°)</button>
</div>

<div id="log" class="log">ì—¬ì •ì´ ì‹œì‘ë˜ì—ˆë‹¤â€¦</div>

</div>

<!-- ì‚¬ìš´ë“œ -->
<audio id="hitSound" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-hit-2187.mp3"></audio>
<audio id="upgradeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<script>
/* ===== ê¸°ë³¸ ìŠ¤íƒ¯ ===== */
let coins = 0;
let atk = 1;
let upgradeLv = 1;
let upgradeChance = 90;

let playerLv = 1;
let exp = 0;
let nextExp = 10;

let monsterHp = 10;
let monsterMaxHp = 10;
let kills = 0;

let idle = false;
let idleTimer = null;

/* ===== ì§€ì—­ ===== */
const areas = [
    { name:"ğŸŒ± ì´ˆì›", minLv:1 },
    { name:"ğŸŒ´ ë°€ë¦¼", minLv:10 },
    { name:"â„ ëˆˆ", minLv:20 },
    { name:"ğŸŒ‹ í™”ì‚°", minLv:30 },
    { name:"ğŸŒŒ ê³µí—ˆ", minLv:40 }
];

const monsters = ["ìŠ¬ë¼ì„","ê³ ë¸”ë¦°","ë¹™ê²°ìˆ˜","í™”ì—¼ë ¹","ì´ë¦„ ì—†ëŠ” ì¡´ì¬"];

/* ===== ì €ì¥ ===== */
function save() {
    localStorage.setItem("yugisaSave", JSON.stringify({
        coins, atk, upgradeLv, upgradeChance,
        playerLv, exp, nextExp, kills
    }));
}

function load() {
    const s = JSON.parse(localStorage.getItem("yugisaSave"));
    if (!s) return;
    Object.assign(window, s);
}

/* ===== ì§€ì—­ ê³„ì‚° ===== */
function areaIndex() {
    let idx = 0;
    for (let i=0;i<areas.length;i++) {
        if (playerLv >= areas[i].minLv) idx = i;
    }
    return idx;
}

/* ===== ëª¬ìŠ¤í„° ===== */
function spawnMonster() {
    const area = areaIndex();
    monsterMaxHp = 15 + kills*3 + area*20;
    monsterHp = monsterMaxHp;
    document.getElementById("monsterName").textContent = monsters[area];
    document.getElementById("areaText").textContent = areas[area].name;
    updateUI();
}

/* ===== ê³µê²© ===== */
function attack() {
    monsterHp -= atk;
    hitSound.play();

    if (monsterHp <= 0) {
        kills++;
        coins += 10 + areaIndex()*5;

        exp += 5 + areaIndex()*3;
        levelUpCheck();

        spawnMonster();
    }
    updateUI();
}

/* ===== ë ˆë²¨ì—… ===== */
function levelUpCheck() {
    while (exp >= nextExp) {
        exp -= nextExp;
        playerLv++;
        nextExp = Math.floor(nextExp*1.4);
        atk++;
        log.textContent = `ğŸ‰ ë ˆë²¨ì—…! LV ${playerLv}`;
    }
}

/* ===== ê°•í™” ===== */
function upgrade() {
    const cost = 20 + upgradeLv*10;
    if (coins < cost) {
        log.textContent = "ğŸ’¸ ì½”ì¸ì´ ë¶€ì¡±í•˜ë‹¤";
        return;
    }

    coins -= cost;

    const realChance = upgradeLv >= 10 ? Math.min(95, upgradeChance+10) : upgradeChance;

    if (Math.random()*100 <= realChance) {
        upgradeLv++;
        atk += upgradeLv >= 10 ? 2 : 1;
        upgradeChance = Math.max(10, upgradeChance-2);
        upgradeSound.play();
        log.textContent = "ğŸ”¥ ê°•í™” ì„±ê³µ!";
    } else {
        log.textContent = "ğŸ’€ ê°•í™” ì‹¤íŒ¨â€¦";
    }
    updateUI();
}

/* ===== ìƒì  ===== */
function buyAtk() {
    if (coins < 50) return;
    coins -= 50;
    atk++;
    log.textContent = "ATK +1 êµ¬ë§¤!";
    updateUI();
}

/* ===== ë°©ì¹˜ ===== */
function toggleIdle() {
    idle = !idle;
    idleText.textContent = idle ? "ON" : "OFF";
    if (idle) {
        idleTimer = setInterval(attack, 1000);
    } else {
        clearInterval(idleTimer);
    }
}

/* ===== UI ===== */
function updateUI() {
    hpFill.style.width = (monsterHp/monsterMaxHp*100)+"%";
    coin.textContent = coins;
    atk.textContent = atk;
    upgradeLv.textContent = upgradeLv;
    chance.textContent = upgradeChance;
    playerLv.textContent = playerLv;

    if (upgradeLv >= 10) {
        upgradeBtn.classList.add("awaken");
        upgradeBtn.textContent = "ğŸ”¥ ê°ì„± ê°•í™”";
    }

    save();
}

/* ===== ì‹œì‘ ===== */
load();
spawnMonster();
updateUI();
</script>
</body>
</html>
